<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MIPS Pong Simulator</title>
<style>
  body {
    background: #121212;
    color: #e0e0e0;
    font-family: 'Consolas', monospace, monospace;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1rem;
    height: 100vh;
    margin: 0;
    user-select: none;
  }
  h1 {
    margin-bottom: 0.5rem;
  }
  #gameCanvas {
    background: #222;
    border: 2px solid #444;
    image-rendering: pixelated;
    margin-bottom: 1rem;
  }
  #registers {
    display: grid;
    grid-template-columns: repeat(3, 120px);
    gap: 1rem;
    margin-bottom: 1rem;
  }
  .reg {
    background: #1e1e1e;
    padding: 0.5rem;
    border-radius: 6px;
    text-align: center;
  }
  .reg strong {
    display: block;
    margin-bottom: 0.3rem;
    color: #90caf9;
  }
  #instructions {
    font-size: 0.9rem;
    color: #999;
    max-width: 600px;
    text-align: center;
  }
</style>
</head>
<body>
<h1>MIPS Pong Simulator</h1>
<canvas id="gameCanvas" width="160" height="100"></canvas>
<div id="registers">
  <div class="reg"><strong>$t0 (ballX)</strong><span id="reg_t0">0</span></div>
  <div class="reg"><strong>$t1 (ballY)</strong><span id="reg_t1">0</span></div>
  <div class="reg"><strong>$t2 (ballDirX)</strong><span id="reg_t2">0</span></div>
  <div class="reg"><strong>$t3 (ballDirY)</strong><span id="reg_t3">0</span></div>
  <div class="reg"><strong>$t4 (paddle1Y)</strong><span id="reg_t4">0</span></div>
  <div class="reg"><strong>$t5 (paddle2Y)</strong><span id="reg_t5">0</span></div>
</div>
<div id="instructions">
  Use <strong>W/S</strong> for Left Paddle and <strong>Arrow Up/Down</strong> for Right Paddle.<br>
  Press <strong>Space</strong> to start/pause the game.
</div>

<script>
(() => {
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  const width = canvas.width;
  const height = canvas.height;

  // Registers (simulate MIPS registers)
  let registers = {
    t0: 10, // ballX
    t1: 50, // ballY
    t2: 1,  // ballDirX (+1 right, -1 left)
    t3: 1,  // ballDirY (+1 down, -1 up)
    t4: 40, // paddle1Y
    t5: 40  // paddle2Y
  };

  // Register display elements
  const regElements = {
    t0: document.getElementById('reg_t0'),
    t1: document.getElementById('reg_t1'),
    t2: document.getElementById('reg_t2'),
    t3: document.getElementById('reg_t3'),
    t4: document.getElementById('reg_t4'),
    t5: document.getElementById('reg_t5')
  };

  // Game state
  let running = false;
  const paddleHeight = 20;
  const paddleWidth = 5;
  const ballSize = 5;
  const paddleSpeed = 2;
  const ballSpeed = 1; // slower ball speed

  // Key state
  const keys = {};

  window.addEventListener('keydown', e => {
    keys[e.key.toLowerCase()] = true;

    if (e.key === ' ') {
      running = !running;
      if (running) {
        loop();
      }
      e.preventDefault();
    }
  });
  window.addEventListener('keyup', e => {
    keys[e.key.toLowerCase()] = false;
  });

  function update() {
    if (!running) return;

    // Move paddles
    if (keys['w'] && registers.t4 > 0) {
      registers.t4 -= paddleSpeed;
    }
    if (keys['s'] && registers.t4 < height - paddleHeight) {
      registers.t4 += paddleSpeed;
    }
    if (keys['arrowup'] && registers.t5 > 0) {
      registers.t5 -= paddleSpeed;
    }
    if (keys['arrowdown'] && registers.t5 < height - paddleHeight) {
      registers.t5 += paddleSpeed;
    }

    // Move ball
    registers.t0 += registers.t2 * ballSpeed;
    registers.t1 += registers.t3 * ballSpeed;

    // Ball collision top/bottom
    if (registers.t1 <= 0) {
      registers.t1 = 0;
      registers.t3 = 1; // invert vertical direction
    }
    if (registers.t1 >= height - ballSize) {
      registers.t1 = height - ballSize;
      registers.t3 = -1;
    }

    // Ball collision left paddle
    if (
      registers.t0 <= paddleWidth &&
      registers.t1 + ballSize >= registers.t4 &&
      registers.t1 <= registers.t4 + paddleHeight
    ) {
      registers.t0 = paddleWidth;
      registers.t2 = 1; // bounce right
    }
    // Ball collision right paddle
    if (
      registers.t0 >= width - paddleWidth - ballSize &&
      registers.t1 + ballSize >= registers.t5 &&
      registers.t1 <= registers.t5 + paddleHeight
    ) {
      registers.t0 = width - paddleWidth - ballSize;
      registers.t2 = -1; // bounce left
    }

    // Ball out of bounds reset
    if (registers.t0 < 0 || registers.t0 > width) {
      // Reset ball position & direction
      registers.t0 = width / 2;
      registers.t1 = height / 2;
      // Random initial direction
      registers.t2 = Math.random() > 0.5 ? 1 : -1;
      registers.t3 = Math.random() > 0.5 ? 1 : -1;
    }
  }

  function draw() {
    ctx.clearRect(0, 0, width, height);

    // Draw paddles
    ctx.fillStyle = '#44aaff';
    ctx.fillRect(0, registers.t4, paddleWidth, paddleHeight);
    ctx.fillRect(width - paddleWidth, registers.t5, paddleWidth, paddleHeight);

    // Draw ball
    ctx.fillStyle = '#ffaa44';
    ctx.fillRect(registers.t0, registers.t1, ballSize, ballSize);
  }

  function updateRegisterDisplay() {
    for (const reg in registers) {
      regElements[reg].textContent = registers[reg].toFixed(1);
    }
  }

  function loop() {
    if (!running) return;
    update();
    draw();
    updateRegisterDisplay();
    requestAnimationFrame(loop);
  }

  // Initial draw & register display
  draw();
  updateRegisterDisplay();
})();
</script>

</body>
</html>
